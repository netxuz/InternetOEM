<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title></title>
  <style>
    #map {
      width: 100%;
      height: 500px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    function initMap() {
      var origen = { lat: -33.431870, lng: -70.641397 };
      var buin = { lat: -33.431713, lng: -70.641692 };
      //var vina = { lat: -33.45, lng: -70.64 };
      var destino = { lat: -33.430975, lng: -70.643627 };
      

      var waypts = [];
      waypts.push({
        location: buin,
        stopover: true
      });
      //waypts.push({
      //  location: vina,
      //  stopover: true
      //});

      var map = new google.maps.Map(document.getElementById('map'), {
        center: origen,
        zoom: 1
      });

      var directionsDisplay = new google.maps.DirectionsRenderer({
        map: map
      });

      // Set destination, origin and travel mode.
      var request = {
        destination: destino,
        origin: origen,
        waypoints: waypts,
        optimizeWaypoints: true,
        travelMode: 'DRIVING'
      };

      // Pass the directions request to the directions service.
      var directionsService = new google.maps.DirectionsService();
      directionsService.route(request, function (response, status) {
        if (status == 'OK') {
          // Display the route on the map.
          directionsDisplay.setDirections(response);
        } else {
          alert(status)
        }
      });

      // Create a marker and set its position.
      //var marker = new google.maps.Marker({
      //  map: map,
      //  position: rancagua,
      //  title: 'Hello World!'
      //});
    }

  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCN4XMdtWhKY4UgLTT45ALRfYuGWFiE7_0&callback=initMap" async defer></script>
</body>
</html>
